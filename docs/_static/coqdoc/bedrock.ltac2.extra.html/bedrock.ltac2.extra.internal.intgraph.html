<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>bedrock.ltac2.extra.internal.intgraph</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library bedrock.ltac2.extra.internal.intgraph</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Ltac2.Ltac2</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.ltac2.extra.internal.list.html#"><span class="id" title="library">bedrock.ltac2.extra.internal.list</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.ltac2.extra.internal.control.html#"><span class="id" title="library">bedrock.ltac2.extra.internal.control</span></a>.<br/>

<br/>
</div>

<div class="doc">
Naive representation of sparse graphs with integer nodes. 
</div>
<div class="code">
<span class="id" title="keyword">Module</span> <a id="IntGraph" class="idref" href="#IntGraph"><span class="id" title="module">IntGraph</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="keyword">Type</span> <span class="id" title="var">t</span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edges</span> : (<span class="id" title="var">int</span> * <span class="id" title="var">int</span>) <span class="id" title="var">list</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">redges</span> : (<span class="id" title="var">int</span> * <span class="id" title="var">int</span>) <span class="id" title="var">list</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inf</span> : <span class="id" title="var">int</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sup</span> : <span class="id" title="var">int</span>;<br/>
&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">cmp</span> (<span class="id" title="var">a</span>,<span class="id" title="var">b</span>) (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <span class="id" title="var">Int.compare</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Int.equal</span> <span class="id" title="var">c</span> 0 <span class="id" title="keyword">then</span> <span class="id" title="var">Int.compare</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="keyword">else</span> <span class="id" title="var">c</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">find</span> (<span class="id" title="var">ab</span> : <span class="id" title="var">_</span> * <span class="id" title="var">_</span>) : <span class="id" title="var">_</span> <span class="id" title="var">list</span> -&gt; <span class="id" title="var">bool</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">acc</span> <span class="id" title="var">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">false</span>, <span class="id" title="var">acc</span>, <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xy</span> :: <span class="id" title="var">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := <span class="id" title="var">cmp</span> <span class="id" title="var">ab</span> <span class="id" title="var">xy</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Int.lt</span> <span class="id" title="var">c</span> 0 <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">false</span>, <span class="id" title="var">acc</span>, (<span class="id" title="var">xy</span> :: <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Int.gt</span> <span class="id" title="var">c</span> 0 <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">go</span> (<span class="id" title="var">xy</span> :: <span class="id" title="var">acc</span>) <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">true</span>, <span class="id" title="var">acc</span>, <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">go</span> [].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">add_edge</span> <span class="id" title="var">edge</span> <span class="id" title="var">edges</span> : <span class="id" title="var">bool</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">edge</span> <span class="id" title="var">edges</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span>, <span class="id" title="var">edges</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="keyword">before</span>, <span class="id" title="keyword">after</span> =&gt; <span class="id" title="var">true</span>, <span class="id" title="var">List.rev_append</span> <span class="id" title="keyword">before</span> (<span class="id" title="var">edge</span> :: <span class="id" title="keyword">after</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">add_edges</span> <span class="id" title="var">edges1</span> <span class="id" title="var">edges2</span> : <span class="id" title="var">bool</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.foldl</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">edge</span> (<span class="id" title="var">changed</span>, <span class="id" title="var">edges</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">changed'</span>, <span class="id" title="var">edges</span>) := <span class="id" title="var">add_edge</span> <span class="id" title="var">edge</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Bool.or</span> <span class="id" title="var">changed</span> <span class="id" title="var">changed'</span>, <span class="id" title="var">edges</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">edges1</span> (<span class="id" title="var">false</span>, <span class="id" title="var">edges2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">inv_edge</span> (<span class="id" title="var">a</span>,<span class="id" title="var">b</span>) := (<span class="id" title="var">b</span>,<span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">max</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">if</span> <span class="id" title="var">Int.ge</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">a</span> <span class="id" title="keyword">else</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">maxs</span> <span class="id" title="var">xs</span> := <span class="id" title="var">List.fold_left</span> <span class="id" title="var">max</span> 0 <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">min</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="keyword">if</span> <span class="id" title="var">Int.le</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">a</span> <span class="id" title="keyword">else</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">mins</span> <span class="id" title="var">xs</span> := <span class="id" title="var">List.fold_left</span> <span class="id" title="var">min</span> 0 <span class="id" title="var">xs</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">add</span> <span class="id" title="var">edge</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">changed</span>, <span class="id" title="var">edges</span>) := <span class="id" title="var">add_edge</span> <span class="id" title="var">edge</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.neg</span> <span class="id" title="var">changed</span> <span class="id" title="keyword">then</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">from</span>,<span class="id" title="var">to</span>) := <span class="id" title="var">edge</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">redges</span>) := <span class="id" title="var">add_edge</span> (<span class="id" title="var">to</span>,<span class="id" title="var">from</span>) (<span class="id" title="var">t</span>.(<span class="id" title="var">redges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">inf</span> := <span class="id" title="var">min</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">Int.sub</span> (<span class="id" title="var">min</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span>) 1) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sup</span> := <span class="id" title="var">max</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>)) (<span class="id" title="var">Int.add</span> (<span class="id" title="var">max</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span>) 1) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">edges</span> := <span class="id" title="var">edges</span>; <span class="id" title="var">redges</span> := <span class="id" title="var">redges</span>; <span class="id" title="var">sup</span> := <span class="id" title="var">sup</span>; <span class="id" title="var">inf</span> := <span class="id" title="var">inf</span> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">del_edge</span> <span class="id" title="var">edge</span> <span class="id" title="var">edges</span> : <span class="id" title="var">bool</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">edge</span> <span class="id" title="var">edges</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span>, <span class="id" title="var">edges</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="keyword">before</span>, <span class="id" title="keyword">after</span> =&gt; <span class="id" title="var">true</span>, <span class="id" title="var">List.rev_append</span> <span class="id" title="keyword">before</span> (<span class="id" title="keyword">after</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">del</span> <span class="id" title="var">edge</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">changed</span>, <span class="id" title="var">edges</span>) := <span class="id" title="var">del_edge</span> <span class="id" title="var">edge</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.neg</span> <span class="id" title="var">changed</span> <span class="id" title="keyword">then</span> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">from</span>,<span class="id" title="var">to</span>) := <span class="id" title="var">edge</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">redges</span>) := <span class="id" title="var">del_edge</span> (<span class="id" title="var">to</span>,<span class="id" title="var">from</span>) (<span class="id" title="var">t</span>.(<span class="id" title="var">redges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">edges</span> := <span class="id" title="var">edges</span>; <span class="id" title="var">redges</span> := <span class="id" title="var">redges</span>; <span class="id" title="var">sup</span> := <span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>); <span class="id" title="var">inf</span> := <span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>) }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">sublist</span> <span class="id" title="var">a</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">ls</span> : <span class="id" title="var">_</span> <span class="id" title="var">list</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> * <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> (<span class="id" title="var">a</span>, <span class="id" title="var">inf</span>) <span class="id" title="var">ls</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">throw_invalid</span>! "invariant violated: (_, t.(inf)) exists in list"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="keyword">before</span>, <span class="id" title="keyword">after</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> (<span class="id" title="var">a</span>, <span class="id" title="var">sup</span>) <span class="id" title="keyword">after</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">throw_invalid</span>! "invariant violated: (_, t.(sup)) exists in list"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="var">es</span>, <span class="id" title="keyword">after</span> =&gt; <span class="id" title="keyword">before</span>, <span class="id" title="var">es</span>, <span class="id" title="keyword">after</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">edges_from'</span> <span class="id" title="var">a</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span> : (<span class="id" title="var">_</span> * <span class="id" title="var">_</span>) <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span> , <span class="id" title="var">xs</span>, <span class="id" title="var">_</span>) := <span class="id" title="var">sublist</span> <span class="id" title="var">a</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xs</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">edges_from</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> returns all edges from <span class="inlinecode"><span class="id" title="var">a</span></span> to any other node <span class="inlinecode"><span class="id" title="var">b</span></span> in
      reverse order on <span class="inlinecode"><span class="id" title="var">b</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">edges_from</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> : (<span class="id" title="var">_</span> * <span class="id" title="var">_</span>) <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edges_from'</span> <span class="id" title="var">a</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">edges_to'</span> <span class="id" title="var">b</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span> : (<span class="id" title="var">_</span> * <span class="id" title="var">_</span>) <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">xs</span>, <span class="id" title="var">_</span>) := <span class="id" title="var">sublist</span> <span class="id" title="var">b</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span> <span class="id" title="var">List.map</span> <span class="id" title="var">inv_edge</span> <span class="id" title="var">xs</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">edges_to</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> returns all edges to <span class="inlinecode"><span class="id" title="var">b</span></span> from any other node <span class="inlinecode"><span class="id" title="var">a</span></span> in
      reverse order on <span class="inlinecode"><span class="id" title="var">a</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">edges_to</span> <span class="id" title="var">b</span> <span class="id" title="var">t</span> : (<span class="id" title="var">_</span> * <span class="id" title="var">_</span>) <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">edges_to'</span> <span class="id" title="var">b</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">redges</span>)).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">add_trans</span></span> <span class="inlinecode">(<span class="id" title="var">x</span>,<span class="id" title="var">y</span>)</span> <span class="inlinecode"><span class="id" title="var">t</span></span> adds edge <span class="inlinecode">(<span class="id" title="var">x</span>,<span class="id" title="var">y</span>)</span> and edges <span class="inlinecode">(<span class="id" title="var">x</span>,<span class="id" title="var">z</span>)</span> for all <span class="inlinecode">(<span class="id" title="var">y</span>,<span class="id" title="var">z</span>)</span>
      in <span class="inlinecode"><span class="id" title="var">t</span></span>. <span class="inlinecode"><span class="id" title="var">add_trans</span></span> <span class="inlinecode">(<span class="id" title="var">x</span>,<span class="id" title="var">y</span>)</span> <span class="inlinecode"><span class="id" title="var">t</span></span> is transitively closed if <span class="inlinecode"><span class="id" title="var">t</span></span> is. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">add_trans</span> (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">edges</span> := (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) :: <span class="id" title="var">List.map</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span>, <span class="id" title="var">z</span>) =&gt; (<span class="id" title="var">x</span>,<span class="id" title="var">z</span>)) (<span class="id" title="var">edges_from</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.foldl</span> <span class="id" title="var">add</span> <span class="id" title="var">edges</span> <span class="id" title="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">mem</span> <span class="id" title="var">edge</span> <span class="id" title="var">t</span> : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">res</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>) := <span class="id" title="var">find</span> <span class="id" title="var">edge</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">res</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">has</span> <span class="id" title="var">t</span> <span class="id" title="var">edge</span> := <span class="id" title="var">mem</span> <span class="id" title="var">edge</span> <span class="id" title="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">has_from</span> <span class="id" title="var">from</span> <span class="id" title="var">t</span> : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="keyword">after</span>) := <span class="id" title="var">find</span> (<span class="id" title="var">from</span>, <span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Option.default</span> <span class="id" title="var">false</span> (<span class="id" title="var">Option.map</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">from'</span>, <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Int.equal</span> <span class="id" title="var">from</span> <span class="id" title="var">from'</span>) (<span class="id" title="var">List.hd_opt</span> <span class="id" title="keyword">after</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">has_to</span> <span class="id" title="var">to</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="keyword">after</span>) := <span class="id" title="var">find</span> (<span class="id" title="var">to</span>, <span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">redges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Option.default</span> <span class="id" title="var">false</span> (<span class="id" title="var">Option.map</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span>, <span class="id" title="var">to'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Int.equal</span> <span class="id" title="var">to</span> <span class="id" title="var">to'</span>) (<span class="id" title="var">List.hd_opt</span> <span class="id" title="keyword">after</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">path</span> (<span class="id" title="var">from</span>,<span class="id" title="var">to</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.or</span> (<span class="id" title="var">Int.le</span> <span class="id" title="var">from</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>))) (<span class="id" title="var">Int.le</span> <span class="id" title="var">to</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>))) <span class="id" title="keyword">then</span> <span class="id" title="var">false</span> <span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.or</span> (<span class="id" title="var">Int.ge</span> <span class="id" title="var">to</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>))) (<span class="id" title="var">Int.ge</span> <span class="id" title="var">from</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>))) <span class="id" title="keyword">then</span> <span class="id" title="var">false</span> <span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">off</span> := <span class="id" title="var">Int.add</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) 1 <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">length</span> := <span class="id" title="var">Int.sub</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>)) <span class="id" title="var">off</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">froms</span> := <span class="id" title="var">Array.make</span> <span class="id" title="var">length</span> <span class="id" title="var">false</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Array.set</span> <span class="id" title="var">froms</span> (<span class="id" title="var">Int.sub</span> <span class="id" title="var">from</span> <span class="id" title="var">off</span>) <span class="id" title="var">true</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">tos</span> := <span class="id" title="var">Array.make</span> <span class="id" title="var">length</span> <span class="id" title="var">false</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Array.set</span> <span class="id" title="var">tos</span> (<span class="id" title="var">Int.sub</span> <span class="id" title="var">to</span> <span class="id" title="var">off</span>) <span class="id" title="var">true</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="tactic">progress</span> := <span class="id" title="var">Ref.ref</span> <span class="id" title="var">true</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">done</span> := <span class="id" title="var">Ref.ref</span> <span class="id" title="var">false</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">update</span> <span class="id" title="var">arr</span> <span class="id" title="var">i</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Array.get</span> <span class="id" title="var">arr</span> (<span class="id" title="var">Int.sub</span> <span class="id" title="var">i</span> <span class="id" title="var">off</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span> =&gt; ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span> =&gt; <span class="id" title="var">Array.set</span> <span class="id" title="var">arr</span> (<span class="id" title="var">Int.sub</span> <span class="id" title="var">i</span> <span class="id" title="var">off</span>) <span class="id" title="var">true</span>; <span class="id" title="var">Ref.set</span> <span class="id" title="tactic">progress</span> <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> () :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Array.iteri</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">from</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">to</span> := <span class="id" title="var">Array.get</span> <span class="id" title="var">tos</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.and</span> <span class="id" title="var">from</span> <span class="id" title="var">to</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Ref.set</span> <span class="id" title="var">done</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">froms</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Ref.get</span> <span class="id" title="var">done</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ref.set</span> <span class="id" title="tactic">progress</span> <span class="id" title="var">false</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Array.iteri</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">from</span> <span class="id" title="var">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.iter</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span>, <span class="id" title="var">from'</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">update</span> <span class="id" title="var">froms</span> <span class="id" title="var">from'</span>) (<span class="id" title="var">edges_from</span> (<span class="id" title="var">Int.add</span> <span class="id" title="var">from</span> <span class="id" title="var">off</span>) <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">froms</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Array.iteri</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">to</span> <span class="id" title="var">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.iter</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">to'</span>, <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">update</span> <span class="id" title="var">tos</span> <span class="id" title="var">to'</span>) (<span class="id" title="var">edges_to</span> (<span class="id" title="var">Int.add</span> <span class="id" title="var">to</span> <span class="id" title="var">off</span>) <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">tos</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Ref.get</span> <span class="id" title="tactic">progress</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span> =&gt; <span class="id" title="var">go</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <span class="id" title="var">go</span> ().<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">of_edges</span> (<span class="id" title="var">edges</span> : (<span class="id" title="var">_</span> * <span class="id" title="var">_</span>) <span class="id" title="var">list</span>) : <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">edges</span> := <span class="id" title="var">List.sort</span> <span class="id" title="var">cmp</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">redges</span> := <span class="id" title="var">List.sort</span> <span class="id" title="var">cmp</span> (<span class="id" title="var">List.map</span> <span class="id" title="var">inv_edge</span> <span class="id" title="var">edges</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">inf</span>, <span class="id" title="var">sup</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.foldl</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">from</span>,<span class="id" title="var">to</span>) (<span class="id" title="var">inf</span>, <span class="id" title="var">sup</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">inf</span> := <span class="id" title="var">mins</span> [<span class="id" title="var">Int.sub</span> <span class="id" title="var">from</span> 1; <span class="id" title="var">Int.sub</span> <span class="id" title="var">to</span> 1; <span class="id" title="var">inf</span>] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sup</span> := <span class="id" title="var">maxs</span> [<span class="id" title="var">Int.add</span> <span class="id" title="var">from</span> 1; <span class="id" title="var">Int.add</span> <span class="id" title="var">to</span> 1; <span class="id" title="var">sup</span>] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">inf</span>, <span class="id" title="var">sup</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="var">edges</span> (0,0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">edges</span> := <span class="id" title="var">edges</span>; <span class="id" title="var">redges</span> := <span class="id" title="var">redges</span>; <span class="id" title="var">inf</span> := <span class="id" title="var">inf</span>; <span class="id" title="var">sup</span> := <span class="id" title="var">sup</span> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">nodes'</span> <span class="id" title="var">edges</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">fst</span> (<span class="id" title="var">x</span>,<span class="id" title="var">_</span>) := <span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">snd</span> (<span class="id" title="var">_</span>,<span class="id" title="var">y</span>) := <span class="id" title="var">y</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.sort_uniq</span> <span class="id" title="var">Int.compare</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">List.rev_append</span> (<span class="id" title="var">List.map</span> <span class="id" title="var">fst</span> <span class="id" title="var">edges</span>) (<span class="id" title="var">List.map</span> <span class="id" title="var">snd</span> <span class="id" title="var">edges</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">nodes</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">_</span> <span class="id" title="var">list</span> := <span class="id" title="var">nodes'</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>)).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">without</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode"><span class="id" title="var">t2</span></span> only keeps exactly those edges of <span class="inlinecode"><span class="id" title="var">t1</span></span> that do not exist
      in <span class="inlinecode"><span class="id" title="var">t2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">without</span> (<span class="id" title="var">t1</span> : <span class="id" title="var">t</span>) (<span class="id" title="var">t2</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">filter</span> <span class="id" title="var">acc</span> <span class="id" title="var">t2_edges</span> <span class="id" title="var">t1_edges</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t1_edges</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">List.rev</span> <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ab</span> :: <span class="id" title="var">t1_edges</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">found</span>, <span class="id" title="var">_</span>, <span class="id" title="var">t2_edges</span>) := <span class="id" title="var">find</span> <span class="id" title="var">ab</span> <span class="id" title="var">t2_edges</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">found</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">filter</span> <span class="id" title="var">acc</span> <span class="id" title="var">t2_edges</span> <span class="id" title="var">t1_edges</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">filter</span> (<span class="id" title="var">ab</span> :: <span class="id" title="var">acc</span>) <span class="id" title="var">t2_edges</span> <span class="id" title="var">t1_edges</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">edges</span> := <span class="id" title="var">filter</span> [] (<span class="id" title="var">t2</span>.(<span class="id" title="var">edges</span>)) (<span class="id" title="var">t1</span>.(<span class="id" title="var">edges</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">of_edges</span> <span class="id" title="var">edges</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">equal</span> (<span class="id" title="var">t1</span> : <span class="id" title="var">t</span>) (<span class="id" title="var">t2</span> : <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.for_all2</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">a</span>,<span class="id" title="var">b</span>) (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Bool.and</span> (<span class="id" title="var">Int.equal</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>) (<span class="id" title="var">Int.equal</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>)) (<span class="id" title="var">t1</span>.(<span class="id" title="var">edges</span>)) (<span class="id" title="var">t2</span>.(<span class="id" title="var">edges</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="keyword">rec</span> <span class="id" title="var">sublists</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">edges</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">x</span>, <span class="id" title="var">_</span>) :: <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">xs</span>, <span class="id" title="var">edges</span>) := <span class="id" title="var">sublist</span> <span class="id" title="var">x</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xs</span> :: <span class="id" title="var">sublists</span> <span class="id" title="var">inf</span> <span class="id" title="var">sup</span> <span class="id" title="var">edges</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">roots</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.map_filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">edges_to</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> [] =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">x</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>) (<span class="id" title="var">nodes</span> <span class="id" title="var">t</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">leaves</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) : <span class="id" title="var">_</span> <span class="id" title="var">list</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.map_filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">edges_from</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> [] =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">x</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>) (<span class="id" title="var">nodes</span> <span class="id" title="var">t</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">inv</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <span class="id" title="var">edges</span> := <span class="id" title="var">t</span>.(<span class="id" title="var">redges</span>); <span class="id" title="var">redges</span> := <span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>) }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">trans_clos</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">clos</span> <span class="id" title="var">f</span> <span class="id" title="var">edges</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">changed</span>, <span class="id" title="var">edges</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.foldl</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.foldl</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) (<span class="id" title="var">changed</span>, <span class="id" title="var">edges</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">new_edges</span> := <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">changed'</span>, <span class="id" title="var">edges</span>) := <span class="id" title="var">add_edges</span> <span class="id" title="var">new_edges</span> <span class="id" title="var">edges</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Bool.or</span> <span class="id" title="var">changed</span> <span class="id" title="var">changed'</span>, <span class="id" title="var">edges</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<span class="id" title="var">sublists</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>)) <span class="id" title="var">edges</span>) (<span class="id" title="var">false</span>, <span class="id" title="var">edges</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">changed</span> <span class="id" title="keyword">then</span> <span class="id" title="var">clos</span> <span class="id" title="var">f</span> <span class="id" title="var">edges</span> <span class="id" title="keyword">else</span> <span class="id" title="var">edges</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">edges</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clos</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">edges</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.map</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span>, <span class="id" title="var">z</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span>,<span class="id" title="var">z</span>)) (<span class="id" title="var">edges_from'</span> <span class="id" title="var">y</span> (<span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>)) (<span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>)) <span class="id" title="var">edges</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">redges</span> := <span class="id" title="var">List.sort_uniq</span> <span class="id" title="var">cmp</span> (<span class="id" title="var">List.map</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) =&gt; (<span class="id" title="var">y</span>,<span class="id" title="var">x</span>)) <span class="id" title="var">edges</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">edges</span> := <span class="id" title="var">edges</span>; <span class="id" title="var">redges</span> := <span class="id" title="var">redges</span>; <span class="id" title="var">inf</span> := <span class="id" title="var">t</span>.(<span class="id" title="var">inf</span>); <span class="id" title="var">sup</span> := <span class="id" title="var">t</span>.(<span class="id" title="var">sup</span>) }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">in_order</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> : <span class="id" title="var">int</span> <span class="id" title="var">list</span> := [] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> : <span class="id" title="var">int</span> <span class="id" title="var">list</span> := <span class="id" title="var">roots</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">loop</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">int</span> <span class="id" title="var">list</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">int</span> <span class="id" title="var">list</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; (<span class="id" title="var">t</span>, <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">n</span> :: <span class="id" title="var">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="var">n</span> :: <span class="id" title="var">l</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">t</span>, <span class="id" title="var">s</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">List.foldl</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span>, <span class="id" title="var">m</span>) (<span class="id" title="var">t</span>,<span class="id" title="var">s</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := (<span class="id" title="var">n</span>, <span class="id" title="var">m</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">t</span> := <span class="id" title="var">del</span> <span class="id" title="var">e</span> <span class="id" title="var">t</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">edges_to</span> <span class="id" title="var">m</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> [] =&gt; <span class="id" title="var">m</span> :: <span class="id" title="var">s</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">s</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t</span>, <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<span class="id" title="var">edges_from</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span>) (<span class="id" title="var">t</span>, <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">loop</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">t</span>,<span class="id" title="var">l</span>) := <span class="id" title="var">loop</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span>.(<span class="id" title="var">edges</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <span class="id" title="var">List.rev</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">throw_invalid</span>! "cycle detected"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">in_rev_order</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) := <span class="id" title="var">in_order</span> (<span class="id" title="var">inv</span> <span class="id" title="var">t</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="keyword">Type</span> <span class="id" title="var">exn</span> ::= [ <span class="id" title="var">Graph</span> (<span class="id" title="var">t</span>) ].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span>2 <span class="id" title="var">msg</span> (<span class="id" title="var">t</span> : <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Message.of_exn</span> (<span class="id" title="var">Graph</span> <span class="id" title="var">t</span>).<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bedrock.ltac2.extra.internal.intgraph.html#IntGraph"><span class="id" title="module">IntGraph</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>