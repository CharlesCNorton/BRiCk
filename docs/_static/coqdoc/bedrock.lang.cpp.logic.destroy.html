<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
-- Copyright (c) 2020 BedRock Systems, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="../css/coqdocjs/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="../css/coqdocjs/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../js/coqdocjs/config.js"></script>
<script type="text/javascript" src="../js/coqdocjs/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <!-- NOTE: These are displayed right to left on the page -->
    <span class="right">
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> `theories/` </a>
      <a href="../../index.html"> Toplevel </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">bedrock.lang.cpp.logic.destroy</h1>

<div class="code">
<span class="comment">(*<br/>
&nbsp;*&nbsp;Copyright&nbsp;(c)&nbsp;2020-2021&nbsp;BedRock&nbsp;Systems,&nbsp;Inc.<br/>
&nbsp;*&nbsp;This&nbsp;software&nbsp;is&nbsp;distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;BedRock&nbsp;Open-Source&nbsp;License.<br/>
&nbsp;*&nbsp;See&nbsp;the&nbsp;LICENSE-BedRock&nbsp;file&nbsp;in&nbsp;the&nbsp;repository&nbsp;root&nbsp;for&nbsp;details.<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">Coq.ZArith.ZArith</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.tactics.html#"><span class="id" title="library">iris.proofmode.tactics</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.lang.cpp.ast.html#"><span class="id" title="library">bedrock.lang.cpp.ast</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.lang.cpp.semantics.html#"><span class="id" title="library">bedrock.lang.cpp.semantics</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">bedrock.lang.cpp.logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.pred.html#"><span class="id" title="library">pred</span></a> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#"><span class="id" title="library">wp</span></a> <a class="idref" href="bedrock.lang.cpp.logic.path_pred.html#"><span class="id" title="library">path_pred</span></a> <a class="idref" href="bedrock.lang.cpp.logic.heap_pred.html#"><span class="id" title="library">heap_pred</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.lang.cpp.logic.dispatch.html#"><span class="id" title="library">bedrock.lang.cpp.logic.dispatch</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#"><span class="id" title="library">bedrock.lang.cpp.heap_notations</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="destroy" class="idref" href="#destroy"><span class="id" title="section">destroy</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="ebf069dbc779b42a15c441a6d39d5f83" class="idref" href="#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="binder">Σ</span></a> : <a class="idref" href="bedrock.lang.cpp.logic.mpred.html#LC.cpp_logic"><span class="id" title="class">cpp_logic</span></a> <a id="thread_info:1" class="idref" href="#thread_info:1"><span class="id" title="binder">thread_info</span></a>} {<a id="baa46ab95945e710a86e84e8dbcf8141" class="idref" href="#baa46ab95945e710a86e84e8dbcf8141"><span class="id" title="binder">σ</span></a>:<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv"><span class="id" title="class">genv</span></a>}.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.destroy.html#resolve_dtor"><span class="id" title="definition">resolve_dtor</span></a></span> <span class="inlinecode"><span class="id" title="var">cls</span></span> <span class="inlinecode"><a class="idref" href="bedrock.noimport.doc.cpp.logic.html#with_Sigma.this"><span class="id" title="variable">this</span></a></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> reduces to <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">dtor'</span></span> <span class="inlinecode"><span class="id" title="var">this'</span></span> where <span class="inlinecode"><span class="id" title="var">dtor'</span></span> is the
      destructor to be called on <span class="inlinecode"><span class="id" title="var">this'</span></span> which is used to destroy <span class="inlinecode"><a class="idref" href="bedrock.noimport.doc.cpp.logic.html#with_Sigma.this"><span class="id" title="variable">this</span></a></span>.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="resolve_dtor" class="idref" href="#resolve_dtor"><span class="id" title="definition">resolve_dtor</span></a> (<a id="cls:4" class="idref" href="#cls:4"><span class="id" title="binder">cls</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.names.html#globname"><span class="id" title="definition">globname</span></a>) (<a id="this:5" class="idref" href="#this:5"><span class="id" title="binder">this</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.values.html#PTRS_INTF_AXIOM.ptr"><span class="id" title="axiom">ptr</span></a>) (<a id="Q:9" class="idref" href="#Q:9"><span class="id" title="binder">Q</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">(</span></a><a id="faddr:6" class="idref" href="#faddr:6"><span class="id" title="binder">faddr</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.values.html#PTRS_INTF_AXIOM.ptr"><span class="id" title="axiom">ptr</span></a>) (<a id="cls_name:7" class="idref" href="#cls_name:7"><span class="id" title="binder">cls_name</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.names.html#globname"><span class="id" title="definition">globname</span></a>) (<a id="this_addr:8" class="idref" href="#this_addr:8"><span class="id" title="binder">this_addr</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.values.html#PTRS_INTF_AXIOM.ptr"><span class="id" title="axiom">ptr</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">),</span></a> <a class="idref" href="bedrock.lang.cpp.logic.mpred.html#LC.mpred"><span class="id" title="definition">mpred</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="bedrock.lang.cpp.logic.mpred.html#LC.mpred"><span class="id" title="definition">mpred</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#fca829f5898babdcb3ae276b9ab14e45"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv_tu"><span class="id" title="projection">genv_tu</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#cls:4"><span class="id" title="variable">cls</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#Gstruct"><span class="id" title="constructor">Gstruct</span></a> <span class="id" title="var">s</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#has_virtual_dtor"><span class="id" title="definition">has_virtual_dtor</span></a> <span class="id" title="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.dispatch.html#resolve_virtual"><span class="id" title="definition">resolve_virtual</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:5"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#cls:4"><span class="id" title="variable">cls</span></a> <span class="id" title="var">s</span>.(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#s_dtor"><span class="id" title="projection">s_dtor</span></a>) <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:9"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:9"><span class="id" title="variable">Q</span></a> (<a class="idref" href="bedrock.lang.cpp.logic.path_pred.html#_global"><span class="id" title="definition">_global</span></a> <span class="id" title="var">s</span>.(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#s_dtor"><span class="id" title="projection">s_dtor</span></a>)) <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#cls:4"><span class="id" title="variable">cls</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:5"><span class="id" title="variable">this</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#Gunion"><span class="id" title="constructor">Gunion</span></a> <span class="id" title="var">u</span>) =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:9"><span class="id" title="variable">Q</span></a> (<a class="idref" href="bedrock.lang.cpp.logic.path_pred.html#_global"><span class="id" title="definition">_global</span></a> <span class="id" title="var">u</span>.(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#u_dtor"><span class="id" title="projection">u_dtor</span></a>)) <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#cls:4"><span class="id" title="variable">cls</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:5"><span class="id" title="variable">this</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>%<span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="resolve_dtor_frame" class="idref" href="#resolve_dtor_frame"><span class="id" title="lemma">resolve_dtor_frame</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a id="cls:10" class="idref" href="#cls:10"><span class="id" title="binder">cls</span></a> <a id="this:11" class="idref" href="#this:11"><span class="id" title="binder">this</span></a> <a id="Q:12" class="idref" href="#Q:12"><span class="id" title="binder">Q</span></a> <a id="Q':13" class="idref" href="#Q':13"><span class="id" title="binder">Q'</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.bi.prelude.html#c4d2389a489ed3709578030625aa8744"><span class="id" title="notation">Forall</span></a> <a id="a:14" class="idref" href="#a:14"><span class="id" title="binder">a</span></a> <a id="b:15" class="idref" href="#b:15"><span class="id" title="binder">b</span></a> <a id="c:16" class="idref" href="#c:16"><span class="id" title="binder">c</span></a><a class="idref" href="bedrock.lang.bi.prelude.html#c4d2389a489ed3709578030625aa8744"><span class="id" title="notation">,</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:12"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#a:14"><span class="id" title="variable">a</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#b:15"><span class="id" title="variable">b</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#c:16"><span class="id" title="variable">c</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q':13"><span class="id" title="variable">Q'</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#a:14"><span class="id" title="variable">a</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#b:15"><span class="id" title="variable">b</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#c:16"><span class="id" title="variable">c</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#0582ac70d883d93be3a66ac50f1c9225"><span class="id" title="notation">|--</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#resolve_dtor"><span class="id" title="definition">resolve_dtor</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#cls:10"><span class="id" title="variable">cls</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:11"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:12"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#resolve_dtor"><span class="id" title="definition">resolve_dtor</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#cls:10"><span class="id" title="variable">cls</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:11"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q':13"><span class="id" title="variable">Q'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#resolve_dtor"><span class="id" title="definition">resolve_dtor</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">case_match</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_match</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X"; <span class="id" title="var">iApply</span> "X". }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">case_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iApply</span> <a class="idref" href="bedrock.lang.cpp.logic.dispatch.html#resolve_virtual_frame"><span class="id" title="lemma">resolve_virtual_frame</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X"; <span class="id" title="var">iApply</span> "X". } }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val"><span class="id" title="definition">delete_val</span></a></span> <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.dispatch.html#dispatch"><span class="id" title="definition">dispatch</span></a></span> <span class="inlinecode"><span class="id" title="var">ty</span></span> <span class="inlinecode"><a class="idref" href="bedrock.noimport.doc.cpp.logic.html#with_Sigma.this"><span class="id" title="variable">this</span></a></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> destruct <span class="inlinecode"><a class="idref" href="bedrock.noimport.doc.cpp.logic.html#with_Sigma.this"><span class="id" title="variable">this</span></a></span> (which is of type <span class="inlinecode"><span class="id" title="var">ty</span></span>).
      The memory is returned to the C++ abstract machine. The continuation <span class="inlinecode"><span class="id" title="var">Q</span></span>
      is applied to the destroyed pointer <span class="inlinecode"><a class="idref" href="bedrock.noimport.doc.cpp.logic.html#with_Sigma.p"><span class="id" title="variable">p</span></a></span> (it might not be equal to <span class="inlinecode"><a class="idref" href="bedrock.noimport.doc.cpp.logic.html#with_Sigma.this"><span class="id" title="variable">this</span></a></span>
      when virtual dispatch is used) and the type <span class="inlinecode"><span class="id" title="var">ty</span></span> from which qualifiers
      are erased.

<div class="paragraph"> </div>

      The <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.dispatch.html#dispatch"><span class="id" title="definition">dispatch</span></a></span> parameter determines whether the call is a *potentially*
      virtual call. If <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.dispatch.html#dispatch"><span class="id" title="definition">dispatch</span></a></span> is true *and the destructor of the class is
      virtual*, then the call is a virtual call.

<div class="paragraph"> </div>

      NOTE in our semantics (unlike the standard) all objects are destroyed
      via destructors. This is justified because the only objects that do not
      have destructors according to the standard have no-op destructors. Thus,
      we can model the "not having a destructor" as an optimization. This
      choice makes the semantics more uniform. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a id="delete_val" class="idref" href="#delete_val"><span class="id" title="definition">delete_val</span></a> (<a id="dispatch:17" class="idref" href="#dispatch:17"><span class="id" title="binder">dispatch</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) (<a id="ty:18" class="idref" href="#ty:18"><span class="id" title="binder">ty</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) (<a id="this:19" class="idref" href="#this:19"><span class="id" title="binder">this</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.values.html#PTRS_INTF_AXIOM.ptr"><span class="id" title="axiom">ptr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Q:20" class="idref" href="#Q:20"><span class="id" title="binder">Q</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.values.html#PTRS_INTF_AXIOM.ptr"><span class="id" title="axiom">ptr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.mpred.html#LC.mpred"><span class="id" title="definition">mpred</span></a>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">ty</span>} : <a class="idref" href="bedrock.lang.cpp.logic.mpred.html#LC.mpred"><span class="id" title="definition">mpred</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tqualified"><span class="id" title="constructor">Tqualified</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ty</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val:21"><span class="id" title="definition">delete_val</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#dispatch:17"><span class="id" title="variable">dispatch</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnamed"><span class="id" title="constructor">Tnamed</span></a> <span class="id" title="var">cls</span>      =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#fca829f5898babdcb3ae276b9ab14e45"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv_tu"><span class="id" title="projection">genv_tu</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <span class="id" title="var">cls</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#Gstruct"><span class="id" title="constructor">Gstruct</span></a> <span class="id" title="var">s</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#dispatch:17"><span class="id" title="variable">dispatch</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#has_virtual_dtor"><span class="id" title="definition">has_virtual_dtor</span></a> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;In&nbsp;this&nbsp;case,&nbsp;use&nbsp;virtual&nbsp;dispatch&nbsp;to&nbsp;invoke&nbsp;the&nbsp;destructor.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#resolve_dtor"><span class="id" title="definition">resolve_dtor</span></a> <span class="id" title="var">cls</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> (<span class="id" title="keyword">fun</span> <a id="fimpl:23" class="idref" href="#fimpl:23"><span class="id" title="binder">fimpl</span></a> <a id="impl_class:24" class="idref" href="#impl_class:24"><span class="id" title="binder">impl_class</span></a> <a id="this':25" class="idref" href="#this':25"><span class="id" title="binder">this'</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="r_ty:26" class="idref" href="#r_ty:26"><span class="id" title="binder">r_ty</span></a> := <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnamed"><span class="id" title="constructor">Tnamed</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#impl_class:24"><span class="id" title="variable">impl_class</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.bi.prelude.html#3100380cbf7f520075624a1979df30b0"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#WPE.mspec"><span class="id" title="definition">mspec</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#fca829f5898babdcb3ae276b9ab14e45"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv_tu"><span class="id" title="projection">genv_tu</span></a>).(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#globals"><span class="id" title="projection">globals</span></a>) <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#r_ty:26"><span class="id" title="variable">r_ty</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tfunction"><span class="id" title="constructor">Tfunction</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tvoid"><span class="id" title="constructor">Tvoid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="bedrock.lang.cpp.semantics.values.html#VALUES_INTF_AXIOM.Vptr"><span class="id" title="constructor">Vptr</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#fimpl:23"><span class="id" title="variable">fimpl</span></a>) (<a class="idref" href="bedrock.lang.cpp.semantics.values.html#VALUES_INTF_AXIOM.Vptr"><span class="id" title="constructor">Vptr</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this':25"><span class="id" title="variable">this'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this':25"><span class="id" title="variable">this'</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#819be4dc49a8dae2dc0d3d5326586385"><span class="id" title="notation">|-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.heap_pred.html#tblockR"><span class="id" title="definition">tblockR</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#r_ty:26"><span class="id" title="variable">r_ty</span></a> 1 <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this':25"><span class="id" title="variable">this'</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#r_ty:26"><span class="id" title="variable">r_ty</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>    =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE&nbsp;the&nbsp;setup&nbsp;with&nbsp;explicit&nbsp;destructors&nbsp;(even&nbsp;when&nbsp;those&nbsp;destructors&nbsp;are&nbsp;trivial)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abstracts&nbsp;away&nbsp;some&nbsp;of&nbsp;the&nbsp;complexities&nbsp;of&nbsp;the&nbsp;underlying&nbsp;C++&nbsp;semantics&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;semantics&nbsp;itself&nbsp;seems&nbsp;less&nbsp;than&nbsp;clear&nbsp;about.&nbsp;<span class="inlinecode"><span class="id" title="var">CITATION</span></span> <span class="inlinecode"><span class="id" title="var">NEEDED</span></span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TODO&nbsp;let's&nbsp;find&nbsp;some&nbsp;justification&nbsp;in&nbsp;the&nbsp;standard.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;In&nbsp;the&nbsp;current&nbsp;implementation,&nbsp;we&nbsp;generate&nbsp;destructor&nbsp;even&nbsp;when&nbsp;they&nbsp;are&nbsp;implicit<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;make&nbsp;the&nbsp;framework&nbsp;a&nbsp;bit&nbsp;more&nbsp;uniform&nbsp;(all&nbsp;objects&nbsp;have&nbsp;destructors)&nbsp;and&nbsp;allow<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;direct&nbsp;desructor&nbsp;calls,&nbsp;e.g.&nbsp;<span class="inlinecode"><span class="id" title="var">c</span>.~<span class="id" title="var">C</span>()</span>,&nbsp;which&nbsp;are&nbsp;encoded&nbsp;as<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">Emember_call</span></span> <span class="inlinecode">...</span> <span class="inlinecode">&quot;~<span class="id" title="var">C</span>&quot;</span> <span class="inlinecode">..</span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE&nbsp;using&nbsp;<span class="inlinecode"><span class="id" title="var">Tfunction</span></span> <span class="inlinecode"><span class="id" title="var">Tvoid</span></span> <span class="inlinecode"><span class="id" title="var">nil</span></span>&nbsp;implicitly&nbsp;requires&nbsp;all&nbsp;destructors<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;have&nbsp;C&nbsp;calling&nbsp;convention.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.bi.prelude.html#3100380cbf7f520075624a1979df30b0"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#WPE.mspec"><span class="id" title="definition">mspec</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#fca829f5898babdcb3ae276b9ab14e45"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv_tu"><span class="id" title="projection">genv_tu</span></a>).(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#globals"><span class="id" title="projection">globals</span></a>) <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tfunction"><span class="id" title="constructor">Tfunction</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tvoid"><span class="id" title="constructor">Tvoid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="bedrock.lang.cpp.semantics.values.html#VALUES_INTF_AXIOM.Vptr"><span class="id" title="constructor">Vptr</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.logic.path_pred.html#_global"><span class="id" title="definition">_global</span></a> <span class="id" title="var">s</span>.(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#s_dtor"><span class="id" title="projection">s_dtor</span></a>)) (<a class="idref" href="bedrock.lang.cpp.semantics.values.html#VALUES_INTF_AXIOM.Vptr"><span class="id" title="constructor">Vptr</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#819be4dc49a8dae2dc0d3d5326586385"><span class="id" title="notation">|-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.heap_pred.html#tblockR"><span class="id" title="definition">tblockR</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a> 1 <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#Gunion"><span class="id" title="constructor">Gunion</span></a> <span class="id" title="var">u</span>)  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Unions&nbsp;cannot&nbsp;have&nbsp;<span class="inlinecode"><span class="id" title="var">virtual</span></span>&nbsp;destructors:&nbsp;we&nbsp;directly&nbsp;invoke&nbsp;the&nbsp;destructor.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.bi.prelude.html#3100380cbf7f520075624a1979df30b0"><span class="id" title="notation">|&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#WPE.mspec"><span class="id" title="definition">mspec</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#fca829f5898babdcb3ae276b9ab14e45"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv_tu"><span class="id" title="projection">genv_tu</span></a>).(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#globals"><span class="id" title="projection">globals</span></a>) <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tfunction"><span class="id" title="constructor">Tfunction</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tvoid"><span class="id" title="constructor">Tvoid</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="bedrock.lang.cpp.semantics.values.html#VALUES_INTF_AXIOM.Vptr"><span class="id" title="constructor">Vptr</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.logic.path_pred.html#_global"><span class="id" title="definition">_global</span></a> <span class="id" title="var">u</span>.(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#u_dtor"><span class="id" title="projection">u_dtor</span></a>)) (<a class="idref" href="bedrock.lang.cpp.semantics.values.html#VALUES_INTF_AXIOM.Vptr"><span class="id" title="constructor">Vptr</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#819be4dc49a8dae2dc0d3d5326586385"><span class="id" title="notation">|-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.heap_pred.html#tblockR"><span class="id" title="definition">tblockR</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a> 1 <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>                =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#::bi_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tarray"><span class="id" title="constructor">Tarray</span></a> <span class="id" title="var">ety</span> <span class="id" title="var">sz</span>   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE&nbsp;array&nbsp;elements&nbsp;are&nbsp;destroyed&nbsp;with&nbsp;non-virtual&nbsp;dispatch.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;replace&nbsp;<span class="inlinecode"><span class="id" title="var">fold_right</span></span> <span class="inlinecode">...</span> <span class="inlinecode"><span class="id" title="var">rev</span></span>&nbsp;by&nbsp;<span class="inlinecode"><span class="id" title="var">fold_left</span></span>?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> (<span class="id" title="keyword">fun</span> <a id="i:27" class="idref" href="#i:27"><span class="id" title="binder">i</span></a> <a id="Q:28" class="idref" href="#Q:28"><span class="id" title="binder">Q</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="p:29" class="idref" href="#p:29"><span class="id" title="binder">p</span></a> := <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#7319aa982d3560038d3dc19bb9b7b55f"><span class="id" title="notation">.[</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.typing.html#erase_qualifiers"><span class="id" title="definition">erase_qualifiers</span></a> <span class="id" title="var">ety</span> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#7319aa982d3560038d3dc19bb9b7b55f"><span class="id" title="notation">!</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.ZArith.BinInt.html#Z.of_nat"><span class="id" title="definition">Z.of_nat</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#i:27"><span class="id" title="variable">i</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#7319aa982d3560038d3dc19bb9b7b55f"><span class="id" title="notation">]</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.pred.html#L.valid_ptr"><span class="id" title="abbreviation">valid_ptr</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#p:29"><span class="id" title="variable">p</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val:21"><span class="id" title="definition">delete_val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="var">ety</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#p:29"><span class="id" title="variable">p</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:28"><span class="id" title="variable">Q</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) (<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.typing.html#erase_qualifiers"><span class="id" title="definition">erase_qualifiers</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Lists.List.html#seq"><span class="id" title="definition">seq</span></a> 0 (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.NArith.BinNat.html#N.to_nat"><span class="id" title="definition">N.to_nat</span></a> <span class="id" title="var">sz</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tref"><span class="id" title="constructor">Tref</span></a> <span class="id" title="var">r_ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Trv_ref"><span class="id" title="constructor">Trv_ref</span></a> <span class="id" title="var">r_ty</span>    =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NOTE&nbsp;rvalue&nbsp;references&nbsp;<span class="inlinecode"><span class="id" title="var">Trv_ref</span></span>&nbsp;are&nbsp;represented&nbsp;as&nbsp;references&nbsp;<span class="inlinecode"><span class="id" title="var">Tref</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#819be4dc49a8dae2dc0d3d5326586385"><span class="id" title="notation">|-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.heap_pred.html#anyR"><span class="id" title="axiom">anyR</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tref"><span class="id" title="constructor">Tref</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.typing.html#erase_qualifiers"><span class="id" title="definition">erase_qualifiers</span></a> <span class="id" title="var">r_ty</span>) 1 <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.typing.html#erase_qualifiers"><span class="id" title="definition">erase_qualifiers</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">ty</span>              =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.heap_notations.html#819be4dc49a8dae2dc0d3d5326586385"><span class="id" title="notation">|-&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.logic.heap_pred.html#anyR"><span class="id" title="axiom">anyR</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.typing.html#erase_qualifiers"><span class="id" title="definition">erase_qualifiers</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a>) 1 <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:20"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:19"><span class="id" title="variable">this</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.typing.html#erase_qualifiers"><span class="id" title="definition">erase_qualifiers</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:18"><span class="id" title="variable">ty</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>%<span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="delete_val_frame" class="idref" href="#delete_val_frame"><span class="id" title="lemma">delete_val_frame</span></a> <a id="dispatch:30" class="idref" href="#dispatch:30"><span class="id" title="binder">dispatch</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a id="ty:31" class="idref" href="#ty:31"><span class="id" title="binder">ty</span></a> <a id="this:32" class="idref" href="#this:32"><span class="id" title="binder">this</span></a> <a id="Q:33" class="idref" href="#Q:33"><span class="id" title="binder">Q</span></a> <a id="Q':34" class="idref" href="#Q':34"><span class="id" title="binder">Q'</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.bi.prelude.html#c4d2389a489ed3709578030625aa8744"><span class="id" title="notation">Forall</span></a> <a id="this':35" class="idref" href="#this':35"><span class="id" title="binder">this'</span></a> <a id="ty:36" class="idref" href="#ty:36"><span class="id" title="binder">ty</span></a><a class="idref" href="bedrock.lang.bi.prelude.html#c4d2389a489ed3709578030625aa8744"><span class="id" title="notation">,</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:33"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this':35"><span class="id" title="variable">this'</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:36"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q':34"><span class="id" title="variable">Q'</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this':35"><span class="id" title="variable">this'</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:36"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#0582ac70d883d93be3a66ac50f1c9225"><span class="id" title="notation">|--</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val"><span class="id" title="definition">delete_val</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#dispatch:30"><span class="id" title="variable">dispatch</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:31"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:32"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:33"><span class="id" title="variable">Q</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val"><span class="id" title="definition">delete_val</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#dispatch:30"><span class="id" title="variable">dispatch</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#ty:31"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#this:32"><span class="id" title="variable">this</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q':34"><span class="id" title="variable">Q'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">ty</span>; <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">dispatch</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">ty</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="tactic">intros</span>; <span class="id" title="var">iIntros</span> "Q [$ X]"; <span class="id" title="var">iRevert</span> "X"; <span class="id" title="var">done</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">induction</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X"; <span class="id" title="var">iApply</span> "X". }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "Q [$ V]". <span class="id" title="var">iRevert</span> "V"; <span class="id" title="var">iApply</span> <span class="id" title="var">IHty</span>; <span class="id" title="var">iIntros</span> (??); <span class="id" title="var">iApply</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">eauto</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">case_match</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">case_match</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X Y"; <span class="id" title="var">iNext</span>; <span class="id" title="var">iRevert</span> "Y"; <span class="id" title="var">iApply</span> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#WPE.mspec_frame"><span class="id" title="lemma">mspec_frame</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "[$ Q]"; <span class="id" title="var">iApply</span> "X"; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">case_match</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X"; <span class="id" title="var">iApply</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#resolve_dtor_frame"><span class="id" title="lemma">resolve_dtor_frame</span></a>; <span class="id" title="var">iIntros</span> (???) "B"; <span class="id" title="var">iNext</span>; <span class="id" title="var">iRevert</span> "B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#WPE.mspec_frame"><span class="id" title="lemma">mspec_frame</span></a>; <span class="id" title="var">iIntros</span> (?) "[$ Q]"; <span class="id" title="var">iApply</span> "X"; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X Y"; <span class="id" title="var">iNext</span>; <span class="id" title="var">iRevert</span> "Y"; <span class="id" title="var">iApply</span> <a class="idref" href="bedrock.lang.cpp.logic.wp.html#WPE.mspec_frame"><span class="id" title="lemma">mspec_frame</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "[$ Q]"; <span class="id" title="var">iApply</span> "X"; <span class="id" title="var">done</span>. } } }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;BEGIN&nbsp;interp&nbsp;*)</span><br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp"><span class="id" title="definition">interp</span></a></span> <span class="inlinecode"><span class="id" title="var">free</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> "runs" <span class="inlinecode"><span class="id" title="var">free</span></span> and then acts like <span class="inlinecode"><span class="id" title="var">Q</span></span>.

<div class="paragraph"> </div>

      NOTE this could directly support update modalities like regular <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.initializers.html#Init.wp"><span class="id" title="abbreviation">wp</span></a></span>s
           but in practice it is always going to occur at the end of a <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.initializers.html#Init.wp"><span class="id" title="abbreviation">wp</span></a></span> which
           means it will already have access to a fancy update.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a id="interp" class="idref" href="#interp"><span class="id" title="definition">interp</span></a> (<a id="free:37" class="idref" href="#free:37"><span class="id" title="binder">free</span></a> : <a class="idref" href="bedrock.lang.cpp.logic.wp.html#FreeTemps"><span class="id" title="abbreviation">FreeTemps</span></a>) (<a id="Q:38" class="idref" href="#Q:38"><span class="id" title="binder">Q</span></a> : <a class="idref" href="bedrock.lang.cpp.logic.wp.html#epred"><span class="id" title="definition">epred</span></a>) : <a class="idref" href="bedrock.lang.cpp.logic.mpred.html#LC.mpred"><span class="id" title="definition">mpred</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#free:37"><span class="id" title="variable">free</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.logic.wp.html#FreeTemps.id"><span class="id" title="constructor">FreeTemps.id</span></a> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:38"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.logic.wp.html#FreeTemps.seq"><span class="id" title="constructor">FreeTemps.seq</span></a> <span class="id" title="var">f</span> <span class="id" title="var">g</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp:39"><span class="id" title="definition">interp</span></a> <span class="id" title="var">f</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp:39"><span class="id" title="definition">interp</span></a> <span class="id" title="var">g</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:38"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.logic.wp.html#FreeTemps.par"><span class="id" title="constructor">FreeTemps.par</span></a> <span class="id" title="var">f</span> <span class="id" title="var">g</span> =&gt; <a class="idref" href="bedrock.lang.bi.prelude.html#3ad7164693adfb9816edb0160af074a6"><span class="id" title="notation">Exists</span></a> <a id="Qf:41" class="idref" href="#Qf:41"><span class="id" title="binder">Qf</span></a> <a id="Qg:42" class="idref" href="#Qg:42"><span class="id" title="binder">Qg</span></a><a class="idref" href="bedrock.lang.bi.prelude.html#3ad7164693adfb9816edb0160af074a6"><span class="id" title="notation">,</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp:39"><span class="id" title="definition">interp</span></a> <span class="id" title="var">f</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Qf:41"><span class="id" title="variable">Qf</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp:39"><span class="id" title="definition">interp</span></a> <span class="id" title="var">g</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Qg:42"><span class="id" title="variable">Qg</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">**</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">(</span></a><a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Qf:41"><span class="id" title="variable">Qf</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Qg:42"><span class="id" title="variable">Qg</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:38"><span class="id" title="variable">Q</span></a><a class="idref" href="bedrock.lang.bi.prelude.html#edd4b90f66987f0e4145840adec59ece"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.logic.wp.html#FreeTemps.delete"><span class="id" title="constructor">FreeTemps.delete</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">addr</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val"><span class="id" title="definition">delete_val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">addr</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q:38"><span class="id" title="variable">Q</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;END&nbsp;interp&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="interp_frame" class="idref" href="#interp_frame"><span class="id" title="lemma">interp_frame</span></a> <a id="free:43" class="idref" href="#free:43"><span class="id" title="binder">free</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a id="Q1:44" class="idref" href="#Q1:44"><span class="id" title="binder">Q1</span></a> <a id="Q2:45" class="idref" href="#Q2:45"><span class="id" title="binder">Q2</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q1:44"><span class="id" title="variable">Q1</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q2:45"><span class="id" title="variable">Q2</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#0582ac70d883d93be3a66ac50f1c9225"><span class="id" title="notation">|--</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#free:43"><span class="id" title="variable">free</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q1:44"><span class="id" title="variable">Q1</span></a> <a class="idref" href="bedrock.lang.bi.prelude.html#1ceed28b6e47de516f82862d053216fa"><span class="id" title="notation">-*</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#interp"><span class="id" title="definition">interp</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#free:43"><span class="id" title="variable">free</span></a> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#Q2:45"><span class="id" title="variable">Q2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">free</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "X"; <span class="id" title="var">iApply</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#delete_val_frame"><span class="id" title="lemma">delete_val_frame</span></a>; <span class="id" title="var">iIntros</span> (??); <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "a"; <span class="id" title="var">iApply</span> <span class="id" title="var">IHfree1</span>; <span class="id" title="var">iApply</span> <span class="id" title="var">IHfree2</span>; <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> "a b"; <span class="id" title="var">iDestruct</span> "b" <span class="id" title="keyword">as</span> (??) "(x &amp; y &amp; z)"; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "f g"; <span class="id" title="var">iApply</span> "a"; <span class="id" title="var">iRevert</span> "g"; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "z". }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bedrock.lang.cpp.logic.destroy.html#destroy"><span class="id" title="section">destroy</span></a>.<br/>
</div>
<!--
-- Copyright (c) 2020 BedRock Systems, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
